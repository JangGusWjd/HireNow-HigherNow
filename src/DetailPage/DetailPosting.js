// 모집 공고 상단에 표시하는 컴포넌트
import styled from "styled-components";
import "../style/DetailPage/DetailPosting.scss";
import { useParams } from "react-router-dom";
import { useState, useEffect } from "react";
import axios from "axios";

const DetailPosting = (props) => {
  const PostingContainer = styled.div`
    width: 100%;
    height: 17rem;
    border-radius: 0.4rem;
    border: 1px solid #c6c6c6;
    margin-top: 2rem;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  `;

  const {
    companyName,
    recruitTitle,
    companyInfo,
    employmentType,
    wage,
    companyAddress,
  } = props;
  const { jobListId } = useParams();

  const [logoUrl, setLogoUrl] = useState("");

  useEffect(() => {
    const fetchLogo = async () => {
      try {
        const response = await axios.get(
          `http://49.247.33.67:8080/logo/${jobListId}`,
          {
            responseType: "blob",
          }
        );

        const reader = new FileReader();
        reader.onloadend = () => {
          setLogoUrl(reader.result);
        };
        reader.readAsDataURL(response.data);
      } catch (error) {
        console.log("Error fetching logo:", error);
      }
    };

    fetchLogo();
  }, [jobListId]);

  return (
    <PostingContainer>
      <div className="postingContainer-top">
        {logoUrl ? (
          <img src={logoUrl} alt="로고" />
        ) : (
          <p>로고를 불러오는 중입니다...</p>
        )}
        <div>
          <h1>{recruitTitle}</h1>
          <span>{companyName}</span>
          <span>{companyInfo}</span>
        </div>
      </div>
      <div className="postingContainer-bottom">
        <div className="posting-info">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="40"
            height="40"
            viewBox="0 0 25 25"
            fill="none"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M12.565 0H12.435C11.3112 0 10.375 5.38596e-08 9.6325 0.0963856C8.8475 0.19759 8.13875 0.421687 7.57 0.96988C7 1.51928 6.7675 2.20241 6.6625 2.95783C6.59125 3.47229 6.57 4.7 6.565 5.75301C4.0375 5.83374 2.51875 6.11807 1.465 7.13494C-1.49012e-07 8.54578 0 10.8181 0 15.3614C0 19.9048 -1.49012e-07 22.1771 1.465 23.588C2.92875 25 5.28625 25 10 25H15C19.7137 25 22.0712 25 23.535 23.588C25 22.1771 25 19.9048 25 15.3614C25 10.8181 25 8.54578 23.535 7.13494C22.4812 6.11807 20.9625 5.83374 18.435 5.75422C18.43 4.7 18.41 3.47229 18.3375 2.95904C18.2325 2.20241 18 1.51928 17.43 0.971084C16.8613 0.421687 16.1525 0.19759 15.3675 0.0963856C14.625 5.38596e-08 13.6875 0 12.565 0ZM16.56 5.7253C16.5538 4.70482 16.5363 3.60723 16.48 3.1988C16.4013 2.64337 16.2675 2.40482 16.105 2.24819C15.9425 2.09157 15.695 1.96265 15.1175 1.88675C14.515 1.80964 13.705 1.80723 12.5 1.80723C11.295 1.80723 10.485 1.80964 9.88125 1.88795C9.305 1.96265 9.0575 2.09157 8.895 2.2494C8.7325 2.40602 8.59875 2.64337 8.52 3.1988C8.46375 3.60843 8.445 4.70482 8.44 5.7253C8.92875 5.72289 9.45 5.72289 10 5.72289H15C15.5513 5.72289 16.0713 5.72289 16.56 5.7253ZM12.5 9.63855C12.7486 9.63855 12.9871 9.73376 13.1629 9.90322C13.3387 10.0727 13.4375 10.3025 13.4375 10.5422V10.5542C14.7987 10.8843 15.9375 11.9193 15.9375 13.353C15.9375 13.5927 15.8387 13.8225 15.6629 13.992C15.4871 14.1614 15.2486 14.2566 15 14.2566C14.7514 14.2566 14.5129 14.1614 14.3371 13.992C14.1613 13.8225 14.0625 13.5927 14.0625 13.353C14.0625 12.8904 13.53 12.2494 12.5 12.2494C11.47 12.2494 10.9375 12.8904 10.9375 13.353C10.9375 13.8157 11.47 14.4578 12.5 14.4578C14.2312 14.4578 15.9375 15.6145 15.9375 17.3699C15.9375 18.8036 14.7987 19.8373 13.4375 20.1687V20.1807C13.4375 20.4204 13.3387 20.6502 13.1629 20.8197C12.9871 20.9891 12.7486 21.0843 12.5 21.0843C12.2514 21.0843 12.0129 20.9891 11.8371 20.8197C11.6613 20.6502 11.5625 20.4204 11.5625 20.1807V20.1687C10.2013 19.8386 9.0625 18.8036 9.0625 17.3699C9.0625 17.1302 9.16127 16.9004 9.33709 16.7309C9.5129 16.5615 9.75136 16.4663 10 16.4663C10.2486 16.4663 10.4871 16.5615 10.6629 16.7309C10.8387 16.9004 10.9375 17.1302 10.9375 17.3699C10.9375 17.8325 11.47 18.4735 12.5 18.4735C13.53 18.4735 14.0625 17.8325 14.0625 17.3699C14.0625 16.9072 13.53 16.2651 12.5 16.2651C10.7688 16.2651 9.0625 15.1084 9.0625 13.353C9.0625 11.9193 10.2013 10.8843 11.5625 10.5542V10.5422C11.5625 10.3025 11.6613 10.0727 11.8371 9.90322C12.0129 9.73376 12.2514 9.63855 12.5 9.63855Z"
              fill="#228B22"
            />
          </svg>
          <div>
            <h3>정규직/비정규직</h3>
            <p>{employmentType}</p>
          </div>
        </div>
        <div className="posting-info">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="40"
            height="40"
            viewBox="0 0 25 25"
            fill="none"
          >
            <path
              d="M12.5 0C5.59675 0 0 5.59675 0 12.5C0 19.4032 5.59675 25 12.5 25C19.4032 25 25 19.4032 25 12.5C25 5.59675 19.4032 0 12.5 0ZM18.2692 14.4231H12.5C12.245 14.4231 12.0004 14.3218 11.8201 14.1414C11.6398 13.9611 11.5385 13.7166 11.5385 13.4615V4.80769C11.5385 4.55268 11.6398 4.30811 11.8201 4.12778C12.0004 3.94746 12.245 3.84615 12.5 3.84615C12.755 3.84615 12.9996 3.94746 13.1799 4.12778C13.3602 4.30811 13.4615 4.55268 13.4615 4.80769V12.5H18.2692C18.5242 12.5 18.7688 12.6013 18.9491 12.7816C19.1295 12.962 19.2308 13.2065 19.2308 13.4615C19.2308 13.7166 19.1295 13.9611 18.9491 14.1414C18.7688 14.3218 18.5242 14.4231 18.2692 14.4231Z"
              fill="#228B22"
            />
          </svg>
          <div>
            <h3>급여</h3>
            <p>월 {wage}원</p>
          </div>
        </div>
        <div className="posting-info">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="40"
            height="40"
            viewBox="0 0 200 208"
            fill="none"
          >
            <path
              d="M136 88C136 92.7468 134.592 97.3869 131.955 101.334C129.318 105.28 125.57 108.357 121.184 110.173C116.799 111.99 111.973 112.465 107.318 111.539C102.662 110.613 98.3859 108.327 95.0294 104.971C91.673 101.614 89.3872 97.3377 88.4612 92.6822C87.5351 88.0266 88.0104 83.201 89.8269 78.8156C91.6434 74.4302 94.7195 70.6819 98.6663 68.0447C102.613 65.4076 107.253 64 112 64C118.365 64 124.47 66.5286 128.971 71.0294C133.471 75.5303 136 81.6348 136 88ZM200 16V192C200 196.243 198.314 200.313 195.314 203.314C192.313 206.314 188.243 208 184 208H40C35.7565 208 31.6869 206.314 28.6863 203.314C25.6857 200.313 24 196.243 24 192V168H8C5.87827 168 3.84344 167.157 2.34315 165.657C0.842854 164.157 0 162.122 0 160C0 157.878 0.842854 155.843 2.34315 154.343C3.84344 152.843 5.87827 152 8 152H24V112H8C5.87827 112 3.84344 111.157 2.34315 109.657C0.842854 108.157 0 106.122 0 104C0 101.878 0.842854 99.8434 2.34315 98.3431C3.84344 96.8429 5.87827 96 8 96H24V56H8C5.87827 56 3.84344 55.1571 2.34315 53.6569C0.842854 52.1566 0 50.1217 0 48C0 45.8783 0.842854 43.8434 2.34315 42.3431C3.84344 40.8429 5.87827 40 8 40H24V16C24 11.7565 25.6857 7.68687 28.6863 4.68629C31.6869 1.68571 35.7565 0 40 0H184C188.243 0 192.313 1.68571 195.314 4.68629C198.314 7.68687 200 11.7565 200 16ZM166.4 139.2C159.316 129.703 149.87 122.225 139 117.51C144.957 112.071 149.13 104.959 150.973 97.106C152.815 89.253 152.24 81.0266 149.323 73.5062C146.407 65.9858 141.285 59.523 134.629 54.9657C127.974 50.4085 120.096 47.9699 112.03 47.9699C103.964 47.9699 96.0861 50.4085 89.4307 54.9657C82.7753 59.523 77.6532 65.9858 74.7365 73.5062C71.8199 81.0266 71.245 89.253 73.0873 97.106C74.9297 104.959 79.1031 112.071 85.06 117.51C74.1684 122.216 64.7004 129.694 57.6 139.2C56.9697 140.04 56.511 140.997 56.2503 142.015C55.9896 143.032 55.9318 144.091 56.0804 145.131C56.229 146.171 56.5809 147.172 57.1162 148.076C57.6515 148.98 58.3595 149.77 59.2 150.4C60.0405 151.03 60.9968 151.489 62.0145 151.75C63.0323 152.01 64.0914 152.068 65.1314 151.92C66.1714 151.771 67.172 151.419 68.076 150.884C68.9799 150.349 69.7697 149.64 70.4 148.8C75.2436 142.342 81.5244 137.1 88.7449 133.49C95.9654 129.88 103.927 128 112 128C120.073 128 128.035 129.88 135.255 133.49C142.476 137.1 148.756 142.342 153.6 148.8C154.873 150.497 156.768 151.62 158.869 151.92C160.969 152.22 163.103 151.673 164.8 150.4C166.497 149.127 167.62 147.232 167.92 145.131C168.22 143.031 167.673 140.897 166.4 139.2Z"
              fill="#228B22"
            />
          </svg>
          <div>
            <h3>회사 주소</h3>
            <p>{companyAddress}</p>
          </div>
        </div>
      </div>
    </PostingContainer>
  );
};

export default DetailPosting;
